<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SIMG 해외여행자보험</title>
    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
    <script src="/js/bootstrap.bundle.js"></script>
    <script src="/js/jquery-3.7.0.js"></script>
    <link rel="stylesheet" href="/css/simgoti.css">
    <script>
        let name;
        let resiA = sessionStorage.getItem("birth").substring(2) || null;
        let resiB
        let phone;
        let email;

        let check1bool = false;

        const regexNum = /[^0-9]/g;

        $(document).ready(function(){
            // 이름
            $("#name-text").on("keyup",function(){
                name = $(this).val();
            });

            // 주민 뒷자리
            $("#resi-text-b").on("keyup",function(){
                resiB = $(this).val();
            });



            // 주민번호 앞자리 관련
            if(resiA == null){
                alert("보험료 간편계산부터 진행해 주세요.");
            }
            else{
                $("#resi-text-a").val(resiA);
                $("#resi-text-a").attr("disabled","disabled");
            }

            // 폰번호 입력 관련
            $("#phone-text").on("keyup", function(){
                // 입력된 값 중 숫자만 골라서 phone 변수에 집어넣기
                let num = $(this).val();
                num = num.replace(regexNum,"");
                phone = num;

                // 숫자만으로 이루어진 num 변수를 하이픈이 들어간 문자열로 치환, text로 집어넣기
                num = num.replace(/^(\d{2,3})(\d{3,4})(\d{4})$/, "$1-$2-$3");
                $(this).val(num);
            });


            // 이메일 뒷부분 입력 관련
            $("#email-text-b").on("keyup", function(){
                $("#email-select").attr("hidden","hidden");
            });
            $("#email-select").on("change", function(){
                if($("#email-select option:selected").val() == "input"){
                    $("#email-text-b").val(null);
                }
            })

            // 약관 동의 체크
            $("#check1").on("click", function () {
                if(!check1bool){
                    check1bool=true;
                    $(this).addClass("checked");
                } else {
                    check1bool = false;
                    $(this).removeClass("checked");
                }
            });

            // 약관 보이기
            $(".show-btn").on("click", function(){
                const showNum = $(this).attr("id").split("-")[2];
                if(!$(this).hasClass("checked")){
                    $(this).addClass("checked");
                    $(".show-div#show-div-"+showNum).removeAttr("hidden");
                    $("#show-btn-"+showNum+" i.closed").attr("hidden","hidden");
                    $("#show-btn-"+showNum+" i.opened").removeAttr("hidden");
                }
                else{
                    $(this).removeClass("checked");
                    $(".show-div#show-div-"+showNum).attr("hidden","hidden");
                    $("#show-btn-"+showNum+" i.closed").removeAttr("hidden");
                    $("#show-btn-"+showNum+" i.opened").attr("hidden","hidden");
                }
            });

            // 확인 버튼 클릭
            $("#apply-btn").on("click",function(){

                console.log(name);
                console.log(resiA);
                console.log(resiB);
                console.log(phone);
                console.log(email);
                if(
                    name != null &&
                    resiA != null &&
                    resiB != null &&
                    phone != null &&
                    email != null
                ){
                    $.ajax({
                        url: "/api/client/addAppSession",
                        type: "POST",
                        data: {
                            name:name,
                            resiA:resiA,
                            resiB:resiB,
                            phone:phone,
                            email:email,
                            cnt:1
                        },
                        success: (data) => {
                            location.href = "/simg/simgOti/applyPurpose";
                        },
                        error: (err) => {

                        }
                    });
                }
            });

            $("html").on("click", function (e){
                if(check1bool){
                    $("#apply-btn").removeAttr("disabled");
                }
                else if(!check1bool){
                    $("#apply-btn").attr("disabled", "disabled");
                }

                email = $("#email-text-a").val() + "@" +$("#email-text-b").val();
            });

        });
    </script>
</head>
<body>
<div class="mainView d-flex flex-column text-center">
    <div class="headerView">
        <h1>로고</h1>
        <h1>SIMG 해외여행자보험</h1>
    </div>
    <div class="contentsView">
        <!-- 상위 탭-->
        <ul class="list-unstyled row">
            <li class="col-3">
                <button id="calculateTab" class="w-100"><span>간편계산</span></button>
            </li>
            <li class="col-3">
                <button class="w-100"><span>보험가입</span></button>
            </li>
            <li class="col-3">
                <button class="w-100"><span>마이페이지</span></button>
            </li>
            <li class="col-3">
                <button class="w-100"><span>QnA</span></button>
            </li>
        </ul>
        <!-- 탭 아래 본문내용-->
        <div id="content">

            <!-- 이름 -->
            <div class="text-start" id="name-div">
                <div class="row">
                    <div class="col-3">
                        <span>이름</span>
                    </div>
                    <div class="col-9">
                        <input type="text" class="form-control" id="name-text">
                    </div>
                </div>
            </div>

            <!-- 주민번호 -->
            <div class="text-start" id="resi-div">
                <div class="row">
                    <div class="col-3">
                        <div><span>주민번호</span></div>
                        <div><span><small>(외국인번호)</small></span></div>
                    </div>
                    <div class="col-9">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <input type="text" class="form-control" id="resi-text-a">
                            </div>

                            <span>-</span>
                            <div>
                                <input type="text" class="form-control" id="resi-text-b">
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <!-- 휴대폰번호 -->
            <div class="text-start" id="phone-div">
                <div class="row">
                    <div class="col-3">
                        <div><span>휴대폰번호</span></div>
                    </div>
                    <div class="col-9">
                            <input type="text" class="form-control" id="phone-text" maxlength="13">
                    </div>
                </div>
            </div>

            <!-- 이메일 -->
            <div class="text-start" id="email-div">
                <div class="row">
                    <div class="col-3">
                        <div><span>이메일</span></div>
                    </div>
                    <div class="col-9">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="">
                                <input type="text" class="form-control" id="email-text-a">
                            </div>

                            <span>@</span>

                            <div class="text-select-div">
                                <input type="text" class="form-control text-select" id="email-text-b">
                                <select name="email-select" id="email-select"
                                        class="form-control text-option" hidden size="6"
                                        style="z-index: 1">
                                    <option value="input">직접입력</option>
                                    <option value="naver.com">naver.com</option>
                                    <option value="daum.com">daum.net</option>
                                    <option value="hanmail.net">hanmail.net</option>
                                    <option value="gmail.com">gmail.com</option>
                                    <option value="nate.com">nate.com</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 약관 동의 -->
            <div>
                <div>
                    <span>보험가입을 위해 <button type="button" class="border-0 bg-white p-0 m-0 show-btn" id="show-btn-0">개인정보수집 등</button>에 동의합니다</span>
                    <button class="check-btn me-3 border-0" id="check1">
                        <span><i class="bi bi-check-circle-fill"></i></span>
                    </button>
                    <div class="show-div text-start" id="show-div-0" hidden>
                        <ul class="list-unstyled">
                            <li>
                                <button type="button" class="show-btn" id="show-btn-1">
                                    이용약관 <i class="bi bi-caret-down-fill closed"></i><i class="bi bi-caret-up-fill opened" hidden></i>
                                </button>
                                <div class="show-div" id="show-div-1" hidden>
                                    <p>
                                        약관
                                    </p>
                                </div>
                            </li>
                            <li>
                                <button type="button" class="show-btn" id="show-btn-2">
                                    단체규약 <i class="bi bi-caret-down-fill closed"></i><i class="bi bi-caret-up-fill opened" hidden></i>
                                </button>
                                <div class="show-div" id="show-div-2" hidden>
                                    <p>
                                        약관
                                    </p>
                                </div>
                            </li>
                            <li>
                                <button type="button" class="show-btn" id="show-btn-3">
                                    개인정보수집 및 이용 <i class="bi bi-caret-down-fill closed"></i><i class="bi bi-caret-up-fill opened" hidden></i>
                                </button>
                                <div class="show-div" id="show-div-3" hidden>
                                    <p>
                                        약관
                                    </p>
                                </div>
                            </li>
                            <li>
                                <button type="button" class="show-btn" id="show-btn-4">
                                    알아두실 사항 <i class="bi bi-caret-down-fill closed"></i><i class="bi bi-caret-up-fill opened" hidden></i>
                                </button>
                                <div class="show-div" id="show-div-4" hidden>
                                    <p>
                                        약관
                                    </p>
                                </div>
                            </li>
                            <li>
                                <button type="button" class="btn main-btn p-2">보험약관</button>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>

            <!-- 신청 버튼 -->
            <button type="button" class="btn main-btn" id="apply-btn" disabled="disabled">확인</button>


        </div>
    </div>


</div>
<div class="footer">
</div>
</body>
<script src="/js/commonjs.js"></script>
</html>